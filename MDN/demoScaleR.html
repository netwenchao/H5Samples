<html>

<head>
    <meta charset="utf-8"></meta>
    <script type="text/javascript" src="http://127.0.0.1/Scripts/jquery/jquery-1.7.2.min.js?v=626">
    </script>
    <style type="text/css">
        #zoomWrapper {
            transform-origin: inherit;
            -webkit-transform-origin: inherit;
            -moz-transform-origin: inherit;
            -o-transform-origin: inherit;
            overflow: hidden;
            position: relative;
        }
        
        #zoomWrapper.rate1 {
            overflow: auto;
            position: inherit;
        }
        
        #zoomWrapper.rateg1 {
            overflow: initial;
        }
        
        .zoomPNoneIE {
            transform-origin: 0 0;
            -ms-transform-origin: 0 0;
            -moz-transform-origin: 0 0;
            -webkit-transform-origin: 0 0;
            -o-transform-origin: 0 0;
        }
        
        .rate1 .zoomPNoneIE {
            transform: inherit;
            -ms-transform-origin: inherit;
            -moz-transform-origin: inherit;
            -webkit-transform-origin: inherit;
            -o-transform-origin: inherit;
        }
    </style>
</head>

<body>
    <div style="width: 800px;margin:0 auto; position: fixed; top:0;left:400px;">
        <select id="zoomCtrl" onchange="reportPageZoomer.scale($(this).val())" style="font-size: 24px;">
            <option value="50">50</option>
            <option value="60">60</option>
            <option value="70">70</option>
            <option value="80">80</option>
            <option value="90">90</option>
            <option value="100" selected="selected">100</option>
            <option value="110">110</option>
            <option value="120">120</option>
            <option value="130">130</option>
            <option value="140">140</option>
        </select>
    </div>
    <div style="width:800px;height:100%;margin:0px auto;background-color: #999;overflow:auto;">
        <div id="reportContent" style="padding: 0px;">
            <div id="ReportTemplate" style="margin: 0px auto; font-family: clean, sans-serif, arial, helvetica; font-size: 18px; padding: 0px; width: 720px; background-color: #FFF;word-break:break-all;" print-content-width="720" print-page-height="980" enable-auto-pager="0"
                data-template="57911b0a-0a57-4138-b0f2-ec4dcc833461">
                <!--打印表头-->
                <div id="PrintHeader">
                    <!--报告头部信息（医院名称、报告单名称）-->
                    <div class="Group ReportHeader" id="ReportHeader" style="padding: 4px 0px; height: 80px;">
                        <h1 style="margin: 0px 0px 6px; padding: 0px; text-align: center; letter-spacing: 6px; font-size: 30px; font-weight: normal;"><span data-field="HospitalName"></span></h1>
                        <h3 style="margin: 0px; padding: 0px; text-align: center; letter-spacing: 6px; font-size: 26px; font-weight: normal;"><span data-field="OrderForOrderDto_ModalityName">CR</span>&nbsp;检查报告单</h3>
                    </div>
                    <div id="ReportBasicInfo">
                        <!--报告日期信息-->
                        <div class="Group" style="padding: 4px 0px;">
                            <table border="0" style="width: 100%;">
                                <tbody>
                                    <tr class="firstRow">
                                        <td style="width: 50%;">检查时间：<span data-field="OrderForOrderDto_StudyDate"></span></td>
                                        <td>审核时间：<span data-field="ApproveDatetime"></span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <!--锚点位置-->
                        <div id="reportAnchor"></div>
                        <!--患者信息-->
                        <div class="Group PatientInfo" style="padding: 4px 0px; border: solid #000; border-width: 2px 0px;">
                            <table border="0" style="width: 100%;">
                                <tbody>
                                    <tr class="firstRow">
                                        <td style="width: 50%;">患者编号：<span data-field="PatientForOrderDto_GlobalPatientId">2005261002</span></td>
                                        <td>影像号：<span data-field="OrderForOrderDto_AccessionNumber">CR2052600001</span></td>
                                    </tr>
                                    <tr>
                                        <td style="width: 50%;">姓名：<span data-field="PatientForOrderDto_Name">DBG</span></td>
                                        <td>住院号：<span data-field="VisitForOrderDto_InpatientNumber"></span></td>
                                    </tr>
                                    <tr>
                                        <td style="width: 50%;">年龄：<span data-field="OrderForOrderDto_Age">44</span><span data-field="OrderForOrderDto_AgeUnit">岁</span></td>
                                        <td>病床号：<span data-field="VisitForOrderDto_BedNumber"></span></td>
                                    </tr>
                                    <tr>
                                        <td style="width: 50%;">性别：<span data-field="PatientForOrderDto_Gender">男</span></td>
                                        <td>申请科室：<span data-field="OrderForOrderDto_ApplyDepartmentName">放射科</span></td>
                                    </tr>
                                    <tr>
                                        <td style="width: 50%;">专项检查：<span data-field="OrderForOrderDto_OrderSpecialClassDicName">否</span></td>
                                        <td></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!--检查项目信息-->
                    <div id="ReportCheckItems">
                        <div class="Group" style="padding: 4px 0px;">备注：<span data-field="OrderForOrderDto_Note"></span></div>
                        <!--检查信息-->
                        <div class="Group" style="padding: 4px 0px;">检查项目：<span id="CheckIems">鼻咽部增强CR(普通检查)</span></div>
                    </div>
                </div>
                <!--报告内容区-->
                <div id="ReportContent">
                    <!--检查所见信息-->
                    <div class="Group" style="padding: 4px 0px;">
                        <div class="GroupTitle" style="margin: 3px 0px; font-weight: bold;">检查所见：</div>
                        <div tabindex="-100" class="GroupContent richArea" id="Findings" style="line-height: 120%; font-size: 22px; min-height: 230px; height: 330px; background: rgb(255, 255, 255);" fixheight="230" contenteditable="true">
                            这个属性设置当前绘线的粗细。属性值必须为正数。默认值是1.0。线宽是指给定路径的中心到两边的粗细。换句话说就是在路径的两边各绘制线宽的一半。因为画布的坐标并不和像素直接对应，当需要获得精确的水平或垂直线的时候要特别注意。在下面的例子中，用递增的宽度绘制了10条直线。最左边的线宽1.0单位。并且，最左边的以及所有宽度为奇数的线并不能精确呈现，这就是因为路径的定位问题。这个属性设置当前绘线的粗细。属性值必须为正数。默认值是1.0。线宽是指给定路径的中心到两边的粗细。换句话说就是在路径的两边各绘制线宽的一半。因为画布的坐标并不和像素直接对应，当需要获得精确的水平或垂直线的时候要特别注意。在下面的例子中，用递增的宽度绘制了10条直线。最左边的线宽1.0单位。并且，最左边的以及所有宽度为奇数的线并不能精确呈现，这就是因为路径的定位问题。
                        </div>
                    </div>
                    <!--印象信息-->
                    <div class="Group" style="padding: 4px 0px;">
                        <div class="GroupTitle" style="margin: 3px 0px; font-weight: bold;">印 象：</div>
                        <div tabindex="-200" class="GroupContent richArea" id="Impression" style="line-height: 120%; font-size: 22px; min-height: 125px; height: 215px; background: rgb(255, 255, 255);" fixheight="125" contenteditable="true">12</div>
                    </div>
                </div>
                <!--打印页尾-->
                <div id="PrintFooter">
                    <!--审核信息-->
                    <div class="Group ApprovalInfo" style="padding: 4px 0px; margin-top: 10px;">
                        <table style="width: 100%;" border="0">
                            <tbody>
                                <tr class="firstRow">
                                    <td style="width: 33%;">申请医师：<span data-field="OrderForOrderDto_ApplyDoctorName"></span></td>
                                    <td style="width: 32%;">报告医师：<span data-field="ReportDoctor" data-userinfo="uid:AA7F8108-C703-44FF-89B1-2BDF84B5C5B0,servernode:HINAMIIS id:5dda0a0a-b947-49fc-b13e-34a068bfba21,imgSign:empty">dwc</span></td>
                                    <td>审核医师：<span data-field="ApproveDoctor"></span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <!--报告底部信息-->
                    <div class="Group ReportBottom" id="ReportBottom" style="padding: 6px 4px 0px 4px; font-size: 14px; border-top: solid 2px #000;">(本报告仅供本院医师参考，不作证明材料之用，请注意保存，丢失不补)</div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        /*
                                                                                                 Zoom ReportContent
                                                                                                 1.init(DomNodeToZoom)
                                                                                                 2.scale(1+)
                                                                                                 */
        var reportPageZoomer = (function() {
            var DomZoomer = function() {
                var isIE = function() {
                    return navigator.userAgent.indexOf("MSIE") > -1;
                };

                var node = null;
                var inited = false;
                var getWrapper = function() {
                    var wrapperId = "zoomWrapper";
                    var wrapper = null;
                    if ((wrapper = $("#" + wrapperId)).size() > 0) {
                        return wrapper;
                    }

                    //width,height,padding-left
                    wrapper = $("<div id=\"zoomWrapper\"><div class=\"zoomer\"><div style=\"width:auto;height:auto;\"></div></div></div>");
                    var zoomer = wrapper.find(".zoomer");
                    if (!isIE()) {
                        zoomer.addClass("zoomPNoneIE");
                    }
                    wrapper.insertBefore(node);
                    wrapper.find(">div:eq(0)>div:eq(0)").append(node);
                    return wrapper;
                };

                var getZoomCss = (function() {
                    return isIE() ? function(r) {
                        return {
                            "zoom": (r * 100) + "%"
                        };
                    } : function(r) {
                        return {
                            "transform": "scale(" + r + ")",
                            "-ms-transform": "scale(" + r + ")",
                            "-moz-transform": "scale(" + r + ")",
                            "-webkit-transform": "scale(" + r + ")",
                            "-o-transform": "scale(" + r + ")",
                            "transform-origin": "0 0",
                            "-ms-transform-origin": "0 0",
                            "-webkit-transform-origin": "0 0",
                            "-moz-transform-origin": "0 0",
                            "-o-transform-origin": "0 0"
                        };
                    };
                })();

                var setScale = function(wrapper, rate) {
                    wrapper.find(".zoomer").css(getZoomCss(rate));
                    var scared = originSize.scaled(rate);
                    wrapper.css(scared);
                    var zClientRect = wrapper.find(".zoomer")[0].getBoundingClientRect();
                    console.log("ZoomerW:" + zClientRect.width);
                    console.log("ScaredW:" + scared.width);
                    wrapper.css("margin-left", Math.round((originSize.width - zClientRect.width) / 2));
                };

                var originSize = {
                    width: 0,
                    height: 0,
                    scaled: function(r) {
                        return {
                            width: r * this.width,
                            height: r * this.height
                        };
                    },
                    saveToNode: function() {
                        node.attr("zoomer_OriginW", this.width);
                        node.attr("zoomer_OriginH", this.height);
                    },
                    refresh: function() {
                        originSize.width = node.width();
                        originSize.height = node.height();
                        this.saveToNode();
                    }
                };

                this.init = function(ele) {
                    node = $(ele);
                };

                this.scale = function(rate) {
                    if (!inited) {
                        originSize.refresh();
                        inited = true;
                    }
                    var w = getWrapper();
                    var r = parseInt(rate);
                    setScale(w, rate / 100);
                    if (r < 100) {
                        w.removeClass("rate1");
                        w.removeClass("rateg1");
                    } else if (r > 100) {
                        w.removeClass("rate1");
                        w.addClass("rateg1");
                    } else { //eq 1
                        w.addClass("rate1");
                        w.removeClass("rateg1");
                    }
                };
            };
            return new DomZoomer();
        })();
        reportPageZoomer.init($("#reportContent"));
    </script>
</body>

</html>